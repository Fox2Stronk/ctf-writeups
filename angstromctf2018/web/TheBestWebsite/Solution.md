# Solution:
When we inspect the site we can see this line at the source code : 

`<!--developers: make sure to record your actions in log.txt-->`

when we go to [log.txt](http://web.angstromctf.com:7667/log.txt) we can see the following text:



> Sat Aug 10 2017 10:23:17 GMT-0400 (EDT) - Initial website

> Sat Aug 10 2017 14:54:07 GMT-0400 (EDT) - Database integration

> Sat Aug 11 2017 14:08:54 GMT-0400 (EDT) - Make some changes to the text

> Sat Mar 17 2018 16:24:17 GMT+0000 (UTC) - Add super secret flag to database


Now we know the flag is in the database, and the exact time it was put in (hmmm, maybe that will come in handy!).


At first glance there's nothing vulnurable about the website... Let's open up burp suite and look for suspicious requests! (or alternatively look at the init.js file)

![burpsuiteAjax](https://raw.githubusercontent.com/Fox2Stronk/ctf-writeups/master/angstromctf2018/web/TheBestWebsite/pics/burp-boxesReqs.png)

hmm what is this suspicious AJAX request? 

let's open it up in a different tab and look at the response: 

![ffDefault](https://raw.githubusercontent.com/Fox2Stronk/ctf-writeups/master/angstromctf2018/web/TheBestWebsite/pics/FFBoxesDefault.png)

Ok, so it seems like we are sending a query to a database which looks like (in PSEUDO SQL/PHP code): 

SELECT * FROM TABLE_NAME Where id = $_GET["id"]'

for each of the ID's provided.

After trying SQL injection and failing miserably, let's search online for the _id field, as we give it as input.

![idGoogleSearch](https://raw.githubusercontent.com/Fox2Stronk/ctf-writeups/master/angstromctf2018/web/TheBestWebsite/pics/idGoogle.png)

We can now tell that the database is MongoDB and that the _id field is generated by it.

Now, let's specifically look at the third result (MongoDB documentation), which explains how the ObjectId is generated.

![idDoc](https://raw.githubusercontent.com/Fox2Stronk/ctf-writeups/master/angstromctf2018/web/TheBestWebsite/pics/idDocumentation.png)

Maybe we can generate an id that will match the flag and select it from the database?


The id is made up from the following:


* a 4-byte value representing the seconds since the Unix epoch  -- We have this value as we know the time the flag was added to the database (from log.txt).

* a 3-byte machine identifier and a 2-byte process id -- we assume this one doesn't differ from the identifiers of the boxes' id.

* a 3-byte counter, starting with a random value. -- assuming only the boxes and the flag are in the database, the flag is either one number below first box's id or one after the last one.

Unix epoch time for Mar 17 2018 16:24:17 is : 5AAD4131

The 5 bytes from the machine id and process id (taken from the ID's that we have) : E07E1E001C

The 3 Byte Counter (we assume the flag was put after the last box) : FCE6D5


so the ID = 5AAD4131E07E1E001CFCE6D5


let's send the get request with our id : [/boxes?ids=5AAD4131E07E1E001CFCE6D5,1,1](http://web.angstromctf.com:7667/boxes?ids=5AAD4131E07E1E001CFCE6D5,1,1)

![flag](https://raw.githubusercontent.com/Fox2Stronk/ctf-writeups/master/angstromctf2018/web/TheBestWebsite/pics/FFGotFlag.png)

BOOM!

actf{0bj3ct_ids_ar3nt_s3cr3ts}
